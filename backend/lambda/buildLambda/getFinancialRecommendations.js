"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getFinancialRecommendations = void 0;
const gpt_1 = require("./gpt");
const getFinancialRecommendations = async (event, context) => {
    console.debug('Sending prompt', event.arguments.chat.prompt);
    const response = await (0, gpt_1.getFinancialRecommendationsFromData)(event.arguments.chat.prompt || '');
    const recommentations = JSON.parse(response.content || '');
    console.debug('Got', recommentations, ' From GPT');
    return recommentations.recommendations.map((el) => ({ ...el, __typename: 'Recommendation' }));
};
exports.getFinancialRecommendations = getFinancialRecommendations;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0RmluYW5jaWFsUmVjb21tZW5kYXRpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2dldEZpbmFuY2lhbFJlY29tbWVuZGF0aW9ucy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFQSwrQkFBMkQ7QUFFcEQsTUFBTSwyQkFBMkIsR0FBa0QsS0FBSyxFQUMzRixLQUFnRCxFQUNoRCxPQUFnQixFQUNsQixFQUFFO0lBQ0EsT0FBTyxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQTtJQUM1RCxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUEseUNBQW1DLEVBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQyxDQUFBO0lBQzdGLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sSUFBSSxFQUFFLENBQUMsQ0FBQTtJQUMxRCxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxlQUFlLEVBQUUsV0FBVyxDQUFDLENBQUE7SUFDbEQsT0FBTyxlQUFlLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQWtCLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsRUFBRSxVQUFVLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDLENBQUE7QUFDakgsQ0FBQyxDQUFBO0FBVFksUUFBQSwyQkFBMkIsK0JBU3ZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwU3luY1Jlc29sdmVyRXZlbnQsIEFwcFN5bmNSZXNvbHZlckhhbmRsZXIsIENvbnRleHQgfSBmcm9tICdhd3MtbGFtYmRhJ1xuaW1wb3J0IHsgQ2hhdFF1ZXJ5LCBSZWNvbW1lbmRhdGlvbiB9IGZyb20gJy4vQVBJJ1xuaW1wb3J0IHsgZ2V0RmluYW5jaWFsUmVjb21tZW5kYXRpb25zRnJvbURhdGEgfSBmcm9tICcuL2dwdCdcblxuZXhwb3J0IGNvbnN0IGdldEZpbmFuY2lhbFJlY29tbWVuZGF0aW9uczogQXBwU3luY1Jlc29sdmVySGFuZGxlcjxhbnksIFJlY29tbWVuZGF0aW9uW10+ID0gYXN5bmMgKFxuICAgIGV2ZW50OiBBcHBTeW5jUmVzb2x2ZXJFdmVudDx7IGNoYXQ6IENoYXRRdWVyeSB9PixcbiAgICBjb250ZXh0OiBDb250ZXh0XG4pID0+IHtcbiAgICBjb25zb2xlLmRlYnVnKCdTZW5kaW5nIHByb21wdCcsIGV2ZW50LmFyZ3VtZW50cy5jaGF0LnByb21wdClcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldEZpbmFuY2lhbFJlY29tbWVuZGF0aW9uc0Zyb21EYXRhKGV2ZW50LmFyZ3VtZW50cy5jaGF0LnByb21wdCB8fCAnJylcbiAgICBjb25zdCByZWNvbW1lbnRhdGlvbnMgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmNvbnRlbnQgfHwgJycpXG4gICAgY29uc29sZS5kZWJ1ZygnR290JywgcmVjb21tZW50YXRpb25zLCAnIEZyb20gR1BUJylcbiAgICByZXR1cm4gcmVjb21tZW50YXRpb25zLnJlY29tbWVuZGF0aW9ucy5tYXAoKGVsOiBSZWNvbW1lbmRhdGlvbikgPT4gKHsgLi4uZWwsIF9fdHlwZW5hbWU6ICdSZWNvbW1lbmRhdGlvbicgfSkpXG59XG4iXX0=