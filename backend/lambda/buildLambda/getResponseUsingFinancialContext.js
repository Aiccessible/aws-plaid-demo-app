"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getResponseUsingFinancialContext = void 0;
const API_1 = require("./API");
const gpt_1 = require("./gpt");
const client_dynamodb_1 = require("@aws-sdk/client-dynamodb");
const Entities_1 = require("./queries/Entities");
const Security_1 = require("./mappers/Security");
const Accounts_1 = require("./mappers/Accounts");
const Transactions_1 = require("./mappers/Transactions");
const CacheEntity_1 = require("./mappers/CacheEntity");
const Encryption_1 = require("./queries/Encryption");
const client = new client_dynamodb_1.DynamoDBClient({ region: 'ca-central-1' });
const dateSupportedFiltering = ['TRANSACTION'];
const mapOfInformationOptionToKey = {
    BANKACCOUNTS: 'ACCOUNT',
    INVESTMENTS: 'SECURITY',
    TRANSACTIONS: 'TRANSACTION',
};
const mapOfCacheTypeToExpiry = {
    [API_1.CacheType.InvestmentAnalysis]: 60 * 60 * 1000 * 4,
    [API_1.CacheType.PortfolioAnalysis]: 60 * 60 * 1000 * 24,
    [API_1.CacheType.StockAnalysis]: 60 * 60 * 1000 * 24,
    [API_1.CacheType.StockNews]: 60 * 60 * 1000 * 4,
    [API_1.CacheType.TransactionRecommendation]: 60 * 60 * 1000 * 24 * 5,
};
const getResponseUsingFinancialContext = async (event, context) => {
    console.info('Get response for', event);
    let neededInfo = { optionsForInformation: [] };
    let dateRangeResponse;
    if (!event.arguments.chat.doNotUseAdvancedRag &&
        !(event.arguments.chat.currentDateRange && event.arguments.chat.highLevelCategory) &&
        !event.arguments.chat.doNotUseAdvancedRag) {
        const informationNeeded = (0, gpt_1.getNeededInformationFromModel)(event.arguments.chat.prompt || '');
        const dateRange = (0, gpt_1.getDateRangeFromModel)(event.arguments.chat.prompt || '');
        await Promise.all([informationNeeded, dateRange]);
        neededInfo = JSON.parse((await informationNeeded).content || '');
        dateRangeResponse = JSON.parse((await dateRange).content || '');
    }
    if (event.arguments.chat.cacheIdentifiers) {
        const cacheChecks = await Promise.all(event.arguments.chat.cacheIdentifiers.map((id) => {
            return client.send((0, Entities_1.GetCacheEntity)({
                id: id.key || '',
                sk: id.cacheType?.toString() ?? '',
                expire_at: Date.now(),
            }));
        }));
        const itemHits = cacheChecks.flatMap((el) => el.Items ?? []);
        if (itemHits.length) {
            return {
                response: itemHits
                    .map(CacheEntity_1.mapDdbResponseToCacheEntity)
                    ?.map((el) => el.response)
                    .join('') || '',
                __typename: 'ChatResponse',
            };
        }
    }
    if (event.arguments.chat.chatFocus === API_1.ChatFocus.Investment &&
        !neededInfo.optionsForInformation.find((el) => el === gpt_1.InformationOptions.INVESTMENTS)) {
        neededInfo.optionsForInformation.push('INVESTMENTS');
    }
    else if ((event.arguments.chat.chatFocus === API_1.ChatFocus.Transaction ||
        event.arguments.chat.chatType === API_1.ChatType.TransactionRecommendation) &&
        !neededInfo.optionsForInformation.find((el) => el === gpt_1.InformationOptions.TRANSACTIONS)) {
        neededInfo.optionsForInformation.push('TRANSACTIONS');
    }
    console.info('Context: ', context);
    console.info('Needed info ', neededInfo);
    console.info('Date range: ', dateRangeResponse);
    const user = event.identity?.username;
    let tupleOfTypeToElements;
    tupleOfTypeToElements = (await Promise.all(neededInfo.optionsForInformation.map(async (option) => {
        const entityName = mapOfInformationOptionToKey[option].toString();
        return await Promise.all(event.arguments.chat.accountIds?.map(async (accountId) => {
            return [
                option,
                await client.send((0, Entities_1.GetEntities)({
                    username: user || '',
                    id: accountId || '',
                    dateRange: entityName in dateSupportedFiltering ? dateRangeResponse : undefined,
                    entityName: entityName,
                    customDateRange: event.arguments.chat?.currentDateRange?.map((el) => el ? parseInt(el) : undefined) ?? undefined,
                    highLevelCategory: event.arguments.chat.highLevelCategory ?? undefined,
                })),
            ];
        }) ?? [option, undefined]);
    }))).flatMap((el) => [...el]);
    console.info(tupleOfTypeToElements, 'good');
    /** Get the contextual data */
    const ddbResponses = await Promise.all(tupleOfTypeToElements.map(async (tuple) => {
        await tuple[0];
        const awaitedTuple = tuple;
        const decryptedItems = await (0, Encryption_1.decryptItemsInBatches)(awaitedTuple[1]?.Items ?? []);
        if (awaitedTuple[0].toString() === 'INVESTMENTS') {
            const mappedData = await (0, Security_1.mapSecuritiesToJoinedData)(decryptedItems);
            return '\nInvestments:\n' + (0, Security_1.mapJointDataToChatInput)(mappedData);
        }
        else if (awaitedTuple[0].toString() === 'TRANSACTIONS') {
            return ('\nTranasactions:\n' +
                decryptedItems.map(Transactions_1.mapDynamoDBToTransaction).map(Transactions_1.mapTransactionToChatInput).join(''));
        }
        else if (awaitedTuple[0].toString() === 'BANKACCOUNTS') {
            return '\nAccounts:\n' + decryptedItems.map(Accounts_1.mapDynamoDBToAccount).map(Accounts_1.mapAccountToChatInput).join('');
        }
        else {
            throw new Error('UNRECOGNIZED OPTION ' + awaitedTuple[0]);
        }
    }));
    const ragData = ddbResponses.join('');
    console.info('FINAL RAG DATA: ', ragData);
    const { prompt } = event.arguments.chat;
    const response = await (0, gpt_1.completeChatFromPrompt)(prompt + ' Use this data for your answer: ' + ragData || '', event.arguments.chat.chatFocus, user, event.arguments.chat.requiresLiveData ?? false, event.arguments.chat.chatType ?? API_1.ChatType.Regular);
    event.arguments.chat.cacheIdentifiers?.map((id) => {
        client.send((0, Entities_1.PutCacheEntity)({
            id: id.key || '',
            expire_at: mapOfCacheTypeToExpiry[id.cacheType] + Date.now(),
            sk: id.cacheType?.toString() ?? '',
        }, { response: { S: response } }));
    });
    return {
        response: response || '',
        __typename: 'ChatResponse',
    };
};
exports.getResponseUsingFinancialContext = getResponseUsingFinancialContext;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0UmVzcG9uc2VVc2luZ0ZpbmFuY2lhbENvbnRleHQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvZ2V0UmVzcG9uc2VVc2luZ0ZpbmFuY2lhbENvbnRleHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsK0JBQStFO0FBQy9FLCtCQUF3SDtBQUN4SCw4REFBNkU7QUFDN0UsaURBQWdGO0FBQ2hGLGlEQUF1RjtBQUN2RixpREFBZ0Y7QUFDaEYseURBQTRGO0FBQzVGLHVEQUFtRTtBQUNuRSxxREFBNEQ7QUFDNUQsTUFBTSxNQUFNLEdBQUcsSUFBSSxnQ0FBYyxDQUFDLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxDQUFDLENBQUE7QUFFN0QsTUFBTSxzQkFBc0IsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFBO0FBRTlDLE1BQU0sMkJBQTJCLEdBQStCO0lBQzVELFlBQVksRUFBRSxTQUFTO0lBQ3ZCLFdBQVcsRUFBRSxVQUFVO0lBQ3ZCLFlBQVksRUFBRSxhQUFhO0NBQzlCLENBQUE7QUFFRCxNQUFNLHNCQUFzQixHQUE4QjtJQUN0RCxDQUFDLGVBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxHQUFHLENBQUM7SUFDbEQsQ0FBQyxlQUFTLENBQUMsaUJBQWlCLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksR0FBRyxFQUFFO0lBQ2xELENBQUMsZUFBUyxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxHQUFHLEVBQUU7SUFDOUMsQ0FBQyxlQUFTLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLEdBQUcsQ0FBQztJQUN6QyxDQUFDLGVBQVMsQ0FBQyx5QkFBeUIsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxHQUFHLEVBQUUsR0FBRyxDQUFDO0NBQ2pFLENBQUE7QUFFTSxNQUFN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LE1BQU0sSUFBQSw0QkFBc0IsRUFDekMsTUFBTSxHQUFHLGtDQUFrQyxHQUFHLE9BQU8sSUFBSSxFQUFFLEVBQzNELEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFDOUIsSUFBSSxFQUNKLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGdCQUFnQixJQUFJLEtBQUssRUFDOUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFJLGNBQVEsQ0FBQyxPQUFPLENBQ3BELENBQUE7SUFDRCxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRTtRQUM5QyxNQUFNLENBQUMsSUFBSSxDQUNQLElBQUEseUJBQWMsRUFDVjtZQUNJLEVBQUUsRUFBRSxFQUFFLENBQUMsR0FBRyxJQUFJLEVBQUU7WUFDaEIsU0FBUyxFQUFFLHNCQUFzQixDQUFDLEVBQUUsQ0FBQyxTQUFVLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFO1lBQzdELEVBQUUsRUFBRSxFQUFFLENBQUMsU0FBUyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUU7U0FDckMsRUFDRCxFQUFFLFFBQVEsRUFBRSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsRUFBRSxDQUNoQyxDQUNKLENBQUE7SUFDTCxDQUFDLENBQUMsQ0FBQTtJQUNGLE9BQU87UUFDSCxRQUFRLEVBQUUsUUFBUSxJQUFJLEVBQUU7UUFDeEIsVUFBVSxFQUFFLGNBQWM7S0FDN0IsQ0FBQTtBQUNMLENBQUMsQ0FBQTtBQXZJWSxRQUFBLGdDQUFnQyxvQ0F1STVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwU3luY0lkZW50aXR5Q29nbml0bywgQXBwU3luY1Jlc29sdmVyRXZlbnQsIEFwcFN5bmNSZXNvbHZlckhhbmRsZXIsIENvbnRleHQgfSBmcm9tICdhd3MtbGFtYmRhJ1xuaW1wb3J0IHsgQ2hhdEZvY3VzLCBDaGF0UXVlcnksIENoYXRSZXNwb25zZSwgQ2hhdFR5cGUsIENhY2hlVHlwZSB9IGZyb20gJy4vQVBJJ1xuaW1wb3J0IHsgSW5mb3JtYXRpb25PcHRpb25zLCBjb21wbGV0ZUNoYXRGcm9tUHJvbXB0LCBnZXREYXRlUmFuZ2VGcm9tTW9kZWwsIGdldE5lZWRlZEluZm9ybWF0aW9uRnJvbU1vZGVsIH0gZnJvbSAnLi9ncHQnXG5pbXBvcnQgeyBEeW5hbW9EQkNsaWVudCwgUXVlcnlDb21tYW5kT3V0cHV0IH0gZnJvbSAnQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiJ1xuaW1wb3J0IHsgR2V0Q2FjaGVFbnRpdHksIEdldEVudGl0aWVzLCBQdXRDYWNoZUVudGl0eSB9IGZyb20gJy4vcXVlcmllcy9FbnRpdGllcydcbmltcG9ydCB7IG1hcEpvaW50RGF0YVRvQ2hhdElucHV0LCBtYXBTZWN1cml0aWVzVG9Kb2luZWREYXRhIH0gZnJvbSAnLi9tYXBwZXJzL1NlY3VyaXR5J1xuaW1wb3J0IHsgbWFwQWNjb3VudFRvQ2hhdElucHV0LCBtYXBEeW5hbW9EQlRvQWNjb3VudCB9IGZyb20gJy4vbWFwcGVycy9BY2NvdW50cydcbmltcG9ydCB7IG1hcER5bmFtb0RCVG9UcmFuc2FjdGlvbiwgbWFwVHJhbnNhY3Rpb25Ub0NoYXRJbnB1dCB9IGZyb20gJy4vbWFwcGVycy9UcmFuc2FjdGlvbnMnXG5pbXBvcnQgeyBtYXBEZGJSZXNwb25zZVRvQ2FjaGVFbnRpdHkgfSBmcm9tICcuL21hcHBlcnMvQ2FjaGVFbnRpdHknXG5pbXBvcnQgeyBkZWNyeXB0SXRlbXNJbkJhdGNoZXMgfSBmcm9tICcuL3F1ZXJpZXMvRW5jcnlwdGlvbidcbmNvbnN0IGNsaWVudCA9IG5ldyBEeW5hbW9EQkNsaWVudCh7IHJlZ2lvbjogJ2NhLWNlbnRyYWwtMScgfSlcblxuY29uc3QgZGF0ZVN1cHBvcnRlZEZpbHRlcmluZyA9IFsnVFJBTlNBQ1RJT04nXVxuZXhwb3J0IHR5cGUgRW50aXR5TmFtZSA9ICdTRUNVUklUWScgfCAnVFJBTlNBQ1RJT04nIHwgJ0FDQ09VTlQnXG5jb25zdCBtYXBPZkluZm9ybWF0aW9uT3B0aW9uVG9LZXk6IFJlY29yZDxzdHJpbmcsIEVudGl0eU5hbWU+ID0ge1xuICAgIEJBTktBQ0NPVU5UUzogJ0FDQ09VTlQnLFxuICAgIElOVkVTVE1FTlRTOiAnU0VDVVJJVFknLFxuICAgIFRSQU5TQUNUSU9OUzogJ1RSQU5TQUNUSU9OJyxcbn1cblxuY29uc3QgbWFwT2ZDYWNoZVR5cGVUb0V4cGlyeTogUmVjb3JkPENhY2hlVHlwZSwgbnVtYmVyPiA9IHtcbiAgICBbQ2FjaGVUeXBlLkludmVzdG1lbnRBbmFseXNpc106IDYwICogNjAgKiAxMDAwICogNCxcbiAgICBbQ2FjaGVUeXBlLlBvcnRmb2xpb0FuYWx5c2lzXTogNjAgKiA2MCAqIDEwMDAgKiAyNCxcbiAgICBbQ2FjaGVUeXBlLlN0b2NrQW5hbHlzaXNdOiA2MCAqIDYwICogMTAwMCAqIDI0LFxuICAgIFtDYWNoZVR5cGUuU3RvY2tOZXdzXTogNjAgKiA2MCAqIDEwMDAgKiA0LFxuICAgIFtDYWNoZVR5cGUuVHJhbnNhY3Rpb25SZWNvbW1lbmRhdGlvbl06IDYwICogNjAgKiAxMDAwICogMjQgKiA1LFxufVxuXG5leHBvcnQgY29uc3QgZ2V0UmVzcG9uc2VVc2luZ0ZpbmFuY2lhbENvbnRleHQ6IEFwcFN5bmNSZXNvbHZlckhhbmRsZXI8YW55LCBDaGF0UmVzcG9uc2U+ID0gYXN5bmMgKFxuICAgIGV2ZW50OiBBcHBTeW5jUmVzb2x2ZXJFdmVudDx7IGNoYXQ6IENoYXRRdWVyeSB9PixcbiAgICBjb250ZXh0OiBDb250ZXh0XG4pID0+IHtcbiAgICBjb25zb2xlLmluZm8oJ0dldCByZXNwb25zZSBmb3InLCBldmVudClcbiAgICBsZXQgbmVlZGVkSW5mbzogeyBvcHRpb25zRm9ySW5mb3JtYXRpb246IEluZm9ybWF0aW9uT3B0aW9uc1tdIH0gPSB7IG9wdGlvbnNGb3JJbmZvcm1hdGlvbjogW10gfVxuICAgIGxldCBkYXRlUmFuZ2VSZXNwb25zZTogYW55XG4gICAgaWYgKFxuICAgICAgICAhZXZlbnQuYXJndW1lbnRzLmNoYXQuZG9Ob3RVc2VBZHZhbmNlZFJhZyAmJlxuICAgICAgICAhKGV2ZW50LmFyZ3VtZW50cy5jaGF0LmN1cnJlbnREYXRlUmFuZ2UgJiYgZXZlbnQuYXJndW1lbnRzLmNoYXQuaGlnaExldmVsQ2F0ZWdvcnkpICYmXG4gICAgICAgICFldmVudC5hcmd1bWVudHMuY2hhdC5kb05vdFVzZUFkdmFuY2VkUmFnXG4gICAgKSB7XG4gICAgICAgIGNvbnN0IGluZm9ybWF0aW9uTmVlZGVkID0gZ2V0TmVlZGVkSW5mb3JtYXRpb25Gcm9tTW9kZWwoZXZlbnQuYXJndW1lbnRzLmNoYXQucHJvbXB0IHx8ICcnKVxuICAgICAgICBjb25zdCBkYXRlUmFuZ2UgPSBnZXREYXRlUmFuZ2VGcm9tTW9kZWwoZXZlbnQuYXJndW1lbnRzLmNoYXQucHJvbXB0IHx8ICcnKVxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbaW5mb3JtYXRpb25OZWVkZWQsIGRhdGVSYW5nZV0pXG4gICAgICAgIG5lZWRlZEluZm8gPSBKU09OLnBhcnNlKChhd2FpdCBpbmZvcm1hdGlvbk5lZWRlZCkuY29udGVudCB8fCAnJylcbiAgICAgICAgZGF0ZVJhbmdlUmVzcG9uc2UgPSBKU09OLnBhcnNlKChhd2FpdCBkYXRlUmFuZ2UpLmNvbnRlbnQgfHwgJycpXG4gICAgfVxuXG4gICAgaWYgKGV2ZW50LmFyZ3VtZW50cy5jaGF0LmNhY2hlSWRlbnRpZmllcnMpIHtcbiAgICAgICAgY29uc3QgY2FjaGVDaGVja3MgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgIGV2ZW50LmFyZ3VtZW50cy5jaGF0LmNhY2hlSWRlbnRpZmllcnMubWFwKChpZCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBjbGllbnQuc2VuZChcbiAgICAgICAgICAgICAgICAgICAgR2V0Q2FjaGVFbnRpdHkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLmtleSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNrOiBpZC5jYWNoZVR5cGU/LnRvU3RyaW5nKCkgPz8gJycsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVfYXQ6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICBjb25zdCBpdGVtSGl0cyA9IGNhY2hlQ2hlY2tzLmZsYXRNYXAoKGVsKSA9PiBlbC5JdGVtcyA/PyBbXSlcbiAgICAgICAgaWYgKGl0ZW1IaXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZTpcbiAgICAgICAgICAgICAgICAgICAgaXRlbUhpdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAobWFwRGRiUmVzcG9uc2VUb0NhY2hlRW50aXR5KVxuICAgICAgICAgICAgICAgICAgICAgICAgPy5tYXAoKGVsKSA9PiBlbC5yZXNwb25zZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCcnKSB8fCAnJyxcbiAgICAgICAgICAgICAgICBfX3R5cGVuYW1lOiAnQ2hhdFJlc3BvbnNlJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoXG4gICAgICAgIGV2ZW50LmFyZ3VtZW50cy5jaGF0LmNoYXRGb2N1cyA9PT0gQ2hhdEZvY3VzLkludmVzdG1lbnQgJiZcbiAgICAgICAgIW5lZWRlZEluZm8ub3B0aW9uc0ZvckluZm9ybWF0aW9uLmZpbmQoKGVsKSA9PiBlbCA9PT0gSW5mb3JtYXRpb25PcHRpb25zLklOVkVTVE1FTlRTKVxuICAgICkge1xuICAgICAgICBuZWVkZWRJbmZvLm9wdGlvbnNGb3JJbmZvcm1hdGlvbi5wdXNoKCdJTlZFU1RNRU5UUycgYXMgYW55KVxuICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIChldmVudC5hcmd1bWVudHMuY2hhdC5jaGF0Rm9jdXMgPT09IENoYXRGb2N1cy5UcmFuc2FjdGlvbiB8fFxuICAgICAgICAgICAgZXZlbnQuYXJndW1lbnRzLmNoYXQuY2hhdFR5cGUgPT09IENoYXRUeXBlLlRyYW5zYWN0aW9uUmVjb21tZW5kYXRpb24pICYmXG4gICAgICAgICFuZWVkZWRJbmZvLm9wdGlvbnNGb3JJbmZvcm1hdGlvbi5maW5kKChlbCkgPT4gZWwgPT09IEluZm9ybWF0aW9uT3B0aW9ucy5UUkFOU0FDVElPTlMpXG4gICAgKSB7XG4gICAgICAgIG5lZWRlZEluZm8ub3B0aW9uc0ZvckluZm9ybWF0aW9uLnB1c2goJ1RSQU5TQUNUSU9OUycgYXMgYW55KVxuICAgIH1cbiAgICBjb25zb2xlLmluZm8oJ0NvbnRleHQ6ICcsIGNvbnRleHQpXG4gICAgY29uc29sZS5pbmZvKCdOZWVkZWQgaW5mbyAnLCBuZWVkZWRJbmZvKVxuICAgIGNvbnNvbGUuaW5mbygnRGF0ZSByYW5nZTogJywgZGF0ZVJhbmdlUmVzcG9uc2UpXG4gICAgY29uc3QgdXNlciA9IChldmVudC5pZGVudGl0eSBhcyBBcHBTeW5jSWRlbnRpdHlDb2duaXRvKT8udXNlcm5hbWVcbiAgICBsZXQgdHVwbGVPZlR5cGVUb0VsZW1lbnRzOiBbSW5mb3JtYXRpb25PcHRpb25zLCBRdWVyeUNvbW1hbmRPdXRwdXRdW11cbiAgICB0dXBsZU9mVHlwZVRvRWxlbWVudHMgPSAoXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAgICAgbmVlZGVkSW5mby5vcHRpb25zRm9ySW5mb3JtYXRpb24ubWFwKGFzeW5jIChvcHRpb24pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbnRpdHlOYW1lID0gbWFwT2ZJbmZvcm1hdGlvbk9wdGlvblRvS2V5W29wdGlvbl0udG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuYXJndW1lbnRzLmNoYXQuYWNjb3VudElkcz8ubWFwKGFzeW5jIChhY2NvdW50SWQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudC5zZW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHZXRFbnRpdGllcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlciB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBhY2NvdW50SWQgfHwgJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlUmFuZ2U6IGVudGl0eU5hbWUgaW4gZGF0ZVN1cHBvcnRlZEZpbHRlcmluZyA/IGRhdGVSYW5nZVJlc3BvbnNlIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5TmFtZTogZW50aXR5TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbURhdGVSYW5nZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXZlbnQuYXJndW1lbnRzLmNoYXQ/LmN1cnJlbnREYXRlUmFuZ2U/Lm1hcCgoZWwpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsID8gcGFyc2VJbnQoZWwpIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSBhcyBhbnkpID8/IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hMZXZlbENhdGVnb3J5OiBldmVudC5hcmd1bWVudHMuY2hhdC5oaWdoTGV2ZWxDYXRlZ29yeSA/PyB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSkgPz8gW29wdGlvbiwgdW5kZWZpbmVkXVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICApLmZsYXRNYXAoKGVsOiBhbnkpID0+IFsuLi5lbF0pIGFzIGFueSBhcyBbSW5mb3JtYXRpb25PcHRpb25zLCBRdWVyeUNvbW1hbmRPdXRwdXRdW11cbiAgICBjb25zb2xlLmluZm8odHVwbGVPZlR5cGVUb0VsZW1lbnRzLCAnZ29vZCcpXG4gICAgLyoqIEdldCB0aGUgY29udGV4dHVhbCBkYXRhICovXG4gICAgY29uc3QgZGRiUmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIHR1cGxlT2ZUeXBlVG9FbGVtZW50cy5tYXAoYXN5bmMgKHR1cGxlKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0dXBsZVswXVxuICAgICAgICAgICAgY29uc3QgYXdhaXRlZFR1cGxlID0gdHVwbGVcbiAgICAgICAgICAgIGNvbnN0IGRlY3J5cHRlZEl0ZW1zID0gYXdhaXQgZGVjcnlwdEl0ZW1zSW5CYXRjaGVzKGF3YWl0ZWRUdXBsZVsxXT8uSXRlbXMgPz8gW10pXG4gICAgICAgICAgICBpZiAoYXdhaXRlZFR1cGxlWzBdLnRvU3RyaW5nKCkgPT09ICdJTlZFU1RNRU5UUycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXBwZWREYXRhID0gYXdhaXQgbWFwU2VjdXJpdGllc1RvSm9pbmVkRGF0YShkZWNyeXB0ZWRJdGVtcylcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1xcbkludmVzdG1lbnRzOlxcbicgKyBtYXBKb2ludERhdGFUb0NoYXRJbnB1dChtYXBwZWREYXRhKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChhd2FpdGVkVHVwbGVbMF0udG9TdHJpbmcoKSA9PT0gJ1RSQU5TQUNUSU9OUycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAnXFxuVHJhbmFzYWN0aW9uczpcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgZGVjcnlwdGVkSXRlbXMubWFwKG1hcER5bmFtb0RCVG9UcmFuc2FjdGlvbikubWFwKG1hcFRyYW5zYWN0aW9uVG9DaGF0SW5wdXQpLmpvaW4oJycpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChhd2FpdGVkVHVwbGVbMF0udG9TdHJpbmcoKSA9PT0gJ0JBTktBQ0NPVU5UUycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1xcbkFjY291bnRzOlxcbicgKyBkZWNyeXB0ZWRJdGVtcy5tYXAobWFwRHluYW1vREJUb0FjY291bnQpLm1hcChtYXBBY2NvdW50VG9DaGF0SW5wdXQpLmpvaW4oJycpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVU5SRUNPR05JWkVEIE9QVElPTiAnICsgYXdhaXRlZFR1cGxlWzBdKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIClcbiAgICBjb25zdCByYWdEYXRhID0gZGRiUmVzcG9uc2VzLmpvaW4oJycpXG4gICAgY29uc29sZS5pbmZvKCdGSU5BTCBSQUcgREFUQTogJywgcmFnRGF0YSlcbiAgICBjb25zdCB7IHByb21wdCB9ID0gZXZlbnQuYXJndW1lbnRzLmNoYXRcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNvbXBsZXRlQ2hhdEZyb21Qcm9tcHQoXG4gICAgICAgIHByb21wdCArICcgVXNlIHRoaXMgZGF0YSBmb3IgeW91ciBhbnN3ZXI6ICcgKyByYWdEYXRhIHx8ICcnLFxuICAgICAgICBldmVudC5hcmd1bWVudHMuY2hhdC5jaGF0Rm9jdXMsXG4gICAgICAgIHVzZXIsXG4gICAgICAgIGV2ZW50LmFyZ3VtZW50cy5jaGF0LnJlcXVpcmVzTGl2ZURhdGEgPz8gZmFsc2UsXG4gICAgICAgIGV2ZW50LmFyZ3VtZW50cy5jaGF0LmNoYXRUeXBlID8/IENoYXRUeXBlLlJlZ3VsYXJcbiAgICApXG4gICAgZXZlbnQuYXJndW1lbnRzLmNoYXQuY2FjaGVJZGVudGlmaWVycz8ubWFwKChpZCkgPT4ge1xuICAgICAgICBjbGllbnQuc2VuZChcbiAgICAgICAgICAgIFB1dENhY2hlRW50aXR5KFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLmtleSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJlX2F0OiBtYXBPZkNhY2hlVHlwZVRvRXhwaXJ5W2lkLmNhY2hlVHlwZSFdICsgRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgc2s6IGlkLmNhY2hlVHlwZT8udG9TdHJpbmcoKSA/PyAnJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHsgcmVzcG9uc2U6IHsgUzogcmVzcG9uc2UgfSB9XG4gICAgICAgICAgICApXG4gICAgICAgIClcbiAgICB9KVxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3BvbnNlOiByZXNwb25zZSB8fCAnJyxcbiAgICAgICAgX190eXBlbmFtZTogJ0NoYXRSZXNwb25zZScsXG4gICAgfVxufVxuIl19